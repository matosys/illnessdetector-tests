<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Illness Detector Playground</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 20px auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        #question { font-size: 18px; margin-bottom: 20px; }
        .option { display: block; margin: 10px 0; padding: 10px; background: #f0f0f0; cursor: pointer; border-radius: 4px; }
        .option:hover { background: #ddd; }
        #result { margin-top: 20px; font-weight: bold; color: #333; }
        #restart { display: none; margin-top: 20px; padding: 10px; background: #007bff; color: white; border: none; cursor: pointer; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Illness Detector Playground</h1>
    <p>This is a fun example app. Not for real medical advice!</p>
    <div id="question"></div>
    <div id="options"></div>
    <div id="result"></div>
    <button id="restart">Restart</button>

    <script>
        let sessionId;

        function startApp() {
            fetch('/api/start')
                .then(res => res.json())
                .then(data => {
                    sessionId = data.session_id;
                    document.getElementById('question').textContent = data.question;
                    displayOptions(data.options);
                });
        }

        function displayOptions(options) {
            const optionsDiv = document.getElementById('options');
            optionsDiv.innerHTML = '';
            options.forEach((text, index) => {
                const btn = document.createElement('div');
                btn.className = 'option';
                btn.textContent = text;
                btn.onclick = () => {
                    fetch(`/api/answer?session_id=${sessionId}&choice=${index}`)
                        .then(res => res.json())
                        .then(data => {
                            if (data.result) {
                                document.getElementById('result').textContent = data.result;
                                optionsDiv.style.display = 'none';
                                document.getElementById('question').style.display = 'none';
                                document.getElementById('restart').style.display = 'block';
                            } else {
                                document.getElementById('question').textContent = data.question;
                                displayOptions(data.options);
                                sessionId = data.session_id;
                            }
                        });
                };
                optionsDiv.appendChild(btn);
            });
        }

        document.getElementById('restart').onclick = () => {
            document.getElementById('result').textContent = '';
            document.getElementById('options').style.display = 'block';
            document.getElementById('question').style.display = 'block';
            document.getElementById('restart').style.display = 'none';
            startApp();
        };

        window.onload = startApp;
    </script>
</body>
</html>